# 1.前言

ICPC竞赛中有FFT(快速傅里叶变换)算法，最近学深度学习又经常遇到傅里叶变换这个词，但是自己并不了解这个东西是什么，所以学一下记录在这里。  
参考：  
[漫士沉思录《傅里叶变换，不过就是坐标分解而已》](https://www.bilibili.com/video/BV1eUHjzgEAd/?spm_id_from=333.337.search-card.all.click&vd_source=8924ad59b4f62224f165e16aa3d04f00)   
[3B1B《形象展示傅里叶变换》](https://www.bilibili.com/video/BV1pW411J7s8/?spm_id_from=333.337.search-card.all.click&vd_source=8924ad59b4f62224f165e16aa3d04f00)

# 2.内容

补充点乘和内积的关系：点乘是内积的一个具体例子，内积是一个更抽象和通用的数学概念。它本质上是定义在某个向量空间上的一个函数

## 2.1.from 漫士

傅里叶变换想要分析的向量是所有的周期函数，选择的基底向量是一系列周期不同的正余弦函数

**基底**：所有形如 `sin(nx)` 和 `cos(mx)` 的周期函数，还有 `1` 。  通过线性组合它们可以表示出几乎所有周期为 $2 \pi$ 的函数  

12:30

把多项式在单项式基底下分解时，只需要看多项式的系数就能得到对应的坐标。但是对于一个波，怎么才能知道几倍的 `cosx` 加几倍的 `cos2x` 加几倍的 `cos3x` 可以得到它呢？  

答案是：**在抽象的向量和抽象的坐标系里，想要找到坐标对应的系数，让基底线性组合得到想要的向量，同样需要一套抽象的办法。这个问题的答案就是内积**  

向量点乘(内积)的几何意义：一个向量在另一个向量方向上的投影长度，乘以另外一个向量的模长。**所以只要将一个向量和x轴的单位向量内积就能自动得到在这个基底方向上的坐标**

上面把向量(或者说坐标)抽象了，点乘也可以抽象一点

**内积的基本性质：**

+ 双线性性：一堆向量加在一起，和另一个向量进行内积运算  等于  这堆向量分别和另一个向量进行内积运算，然后加在一起
+ 对称性： $\langle u,v \rangle = \langle v,u \rangle$ 类似于乘法交换律
+ 非负性：自己和自己的内积一定是非负的，当且仅当所有坐标都是0时结果才为0

这样就可以把任何向量直接和基底向量内积得到该基底方向对应的系数，也就是该方向对应的坐标。**这里其实还有一个前提，那就是任何两个基底内积的结果都需要是0，换句话说要求正交基底。**因为只有单位正交的基底才能通过内积的方式还原出线性组合的坐标。

**接下来，如何定义两个函数的内积？**

离散地看待函数，每个函数就是一个有限长的向量。两个向量的内积就是每个位置的坐标相乘再加到一起，这相当于把两个函数各个不同自变量的值相乘再加到一块。再把这个有限长向量的长度不断增加，趋近无穷，这相当于把两个函数相乘之后在一段周期内把所有函数值加起来，这有一个非常自然的表示那就是积分，于是，有了两个周期函数内积的表达式


$$
\langle f,g \rangle = \int_0^T f(x)g(x) dx
$$
**最后一步，正交的性质**

假设关注的函数周期都是 $2 \pi$，从所有基底里任意选出两个正余弦函数（只要不是同一个），乘在一起可以积化和差最后变成一个在 $0-2 \pi$ 区间内正负面积刚好相互抵消的函数，换句话说也就是在上面定义的乘积积分下两两正交。所以这些正余弦函数的基底自动满足了正交性



**补充和差化积**

+ $cos(a)sin(b)=\frac{1}{2}(sin(a+b)-sin(a-b))$
+ $cos(a)cos(b)=\frac{1}{2}(cos(a+b)+cos(a-b))$
+ $sin(a)sin(b)=-\frac{1}{2}(cos(a+b)-cos(a-b))$



**随便找几个基底验算一下正交性**

1.  $cos(x)cos(2x)=\frac{1}{2}*(cos(3x) + cos(-x))$ 

显然这个表达式在任意 $2 \pi$ 区间内正负面积相同，积分为0。

> 我还是比较抗拒拿“显然”说事，这里试着拿自然语言进一步解释： $cos(x)$ 在任意 $2\pi$ 区间内正负面积相同应该是显然的， $cos(3x)$ 把周期压缩了， $cos(-x)$ 等同于 $cos(x)$ （偶函数），它们各自正负面积相同，相加之后乘以1/2之后同样正负面积相同

2.  $sin(x)sin(3x)=-\frac{1}{2}(cos(4x)-cos(-2x))$

显然

3.  $cos(4x)sin(x)=\frac{1}{2}(sin(5x)-sin(3x))$

同理 $sin(5x)和-sin(3x)$ 各自满足正负面积相等，相加乘以常数后同样满足



**如何知道基底对应的系数？**

拿基底和目标函数内积一下就知道了



**总结**

我们拥有了一个强大的周期函数的坐标系，基底是所有形如 $sin(nx)$ 和 $cos(mx)$ 的周期函数，还有一个 $1$   

通过线性组合它们可以表示出几乎所有周期为 $2\pi$ 的函数  

方波为例，把方波和这些基底分别相乘再积分就可以得到一系列坐标的系数，系数组合对应基底叠加在一起就可以拟合方波



 **最后再来看一下圆上圆是怎么拟合出任意图形的**

> 看评论区说用的是python的manim库 

提到了“基底的运动就是 $e^{in \pi t}$ ”，这是什么呢？

根据欧拉公式 $e^{i\theta} = cos \theta+isin\theta$ 有 $e^{in \pi t}=cosn(n \pi t)+isin(n \pi t)$

+ 它是一个**单位复数**，模始终为1  
+ 它描述了一个**在复平面上以恒定角速度旋转的点**  
+  $n \pi t$ 是旋转的**角度**（单位为弧度）  
+  $n\pi$ 是角速度（旋转得多快）  
+ $t$ 是**时间**  

当 $t$ 增加时，这个点就在复平面的单位圆上画圈  

在这里，把 $e^{in\pi t}$ 中的 $n$ 取不同整数时的表达式作为不同的基底，不同基底之间的区别是角速度不同（包括大小和方向），用基底前的不同系数来控制半径  

manim的环境没有搞定，好吧先不试着自己做动画了，接着看看3B1B是怎么讲傅里叶变换的

## 2.2.from 3B1B

最开始展示了三个图像

1. $g(t)$ 波的 强度-时间 图 

2. 二维平面中的缠绕图像，把上述图像缠绕到圆上

> 具体是确定一个旋转速度（多少圈每秒），每个时刻波的强度用到圆心的距离来表示。要考虑方向，也就是说当前旋转到了90度，强度是-50，那图像位置处在反向的距离圆心50的地方

3.  $\hat{g}(f)$ 缠绕频率（旋转速度）如何影响图像的质心(纵坐标横坐标分别是**质心位置横坐标**和**旋转速度**)

第三张图被博主称为原信号的**“近傅里叶变换”**

当缠绕频率与波的频率相同时，质心会有明显的偏移（比如缠绕速度是3圈/秒(频率3HZ)，波在1秒内有3个周期(频率3HZ)的时候），”近傅里叶变换“的图像会有尖峰出现



把一个周期为2Hz和一个周期为3Hz的图像叠加在一起，然后做“近傅里叶变换”，得到的图像会在转速为2圈每秒和3圈每秒处出现尖峰  

这是因为对两个信号分别做“近傅里叶变换”再叠加到一起，和先把它们叠加到一起再做“近傅里叶变换”得到的图像是一样的  



然后提到了**傅里叶逆变换**，还没有介绍真正的傅里叶变换是什么  

把傅里叶变换之后的图像的某个尖峰去掉(这对应了组成原波形的某个波)，然后做逆傅里叶变换，就能在原波形中去掉对应的波了。

用欧拉公式 $e^{2 \pi it}$ 来描述点在复平面上的旋转，在旋转过2中离圆心的距离(也就是原波的强度会变化)，直接在前面乘上原波形得到 $g(t)e^{-2 \pi ift}$ ，多了一个 $f$ ，用于修改旋转频率，负号使其顺时针转动



**怎么找质心？**  

估计一下，可以试试在原图像上取一堆样本点，然后看它们在缠绕好的图上处在什么位置，然后取平均。取的点越多结果也就越准确  

取极限，相当于对函数做积分然后除以时间区间的长度
$$
\frac{1}{t_2-t_1}\int_{t_1}^{t_2}g(t)e^{-2\pi ift}dt
$$
上面这个表达式的含义相当于绕好的图的质心

 

**只需要再做一步变化就是真正的傅里叶变换了，那就是不要除以时间长度**

其含义不再是质心，而是把它倍增。原图像持续得越久，傅里叶变换的模长就被放得越大，缠绕后的图像就离圆心越远。

